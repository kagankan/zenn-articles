---
title: "原則 4. 堅牢 (Robust) を読んでみよう"
---


## 原則 4. 堅牢 (Robust) とは

そもそも「堅牢（Robust、ロバスト）」ってどういう意味なんでしょう。
超簡単にいえば「丈夫」とか「壊れにくい」的なことだそうです。
情報工学では、「外れ値が入っても壊れない」などのこと。
https://ja.wikipedia.org/wiki/%E3%83%AD%E3%83%90%E3%82%B9%E3%83%88%E3%83%8D%E3%82%B9

語源は、オーク材が頑丈なことから、「オーク材の」を意味するラテン語から来ているそうです。
https://gogen-ejd.info/robust/

さて、原則を読んでみましょう。

>コンテンツは、支援技術を含む様々なユーザエージェントが確実に解釈できるように十分に堅牢でなければならない。
>https://waic.jp/translations/WCAG21/#robust

**ブラウザが正しく表示できるように、壊れにくく作りましょう。**

## ガイドライン 4.1: 互換性

>現在及び将来の、支援技術を含むユーザエージェントとの互換性を最大化すること。
>[ガイドライン 4.1: 互換性を理解する](https://waic.jp/translations/WCAG21/Understanding/compatible.html)

**どんな環境で使っても動くようにしましょう。**

「Chromeでは動くけどSafariではどうかわかりません！」でもダメだし、「今は動くけど来年はどうかわかりません！」でもダメだし、「ブラウザでは動くけど読み上げソフトでは使えません！」もダメ。

###  4.1.1 構文解析 (レベル A)

> マークアップ言語を用いて実装されているコンテンツにおいては、要素には完全な開始タグ及び終了タグがあり、要素は仕様に準じて入れ子になっていて、要素には重複した属性がなく、どの ID も一意的である。ただし、仕様で認められているものを除く。
>[達成基準 4.1.1: 構文解析を理解する](https://waic.jp/translations/WCAG21/Understanding/parsing.html)

**正しいHTMLを書きましょう。**

具体的には以下を守りましょう！

- [x] **完全な** 開始タグと終了タグがある。
  - 山カッコ（`>`）が欠けていたりとか、引用符（`"`）が対応していなかったりすると、「完全な」ではなくなる。
- [x] 要素の入れ子ルールを守っている。
- [x] 一つの要素に重複した属性を設定していない。
- [x] ページ内でidを一意にする。

「ちょっとくらい間違っていても、ブラウザで表示できたからOK！」と思うこともあるかもしれません。
ですが、その裏では、ブラウザが正しくないHTML（たとえば、必要な閉じタグが抜けてるとか）も「まあこういうことだろうな」と「修復」して表示しています。
この修復方法はブラウザによって違うので、あるブラウザで正しく表示できたからと言って、他のブラウザでも表示できるとは限りません。
だから、どんなブラウザでも正しく表示される「丈夫さ」のために、正しいHTMLを書きましょう。

###  4.1.2 名前 (name)・役割 (role) 及び値 (value) (レベル A)

リンク、ボタンなどの、機能の部分に関する話です。

> すべてのユーザインタフェース コンポーネント (フォームを構成する要素、リンク、スクリプトが生成するコンポーネントなど) では、名前 (name) 及び役割 (role) は、プログラムによる解釈が可能である。又、状態、プロパティ、利用者が設定可能な値はプログラムによる設定が可能である。そして、支援技術を含むユーザエージェントが、これらの項目に対する変更通知を利用できる。
> [達成基準 4.1.2: 名前 (name)・役割 (role) 及び値 (value) を理解する](https://waic.jp/translations/WCAG21/Understanding/name-role-value.html)

**操作する（クリックしたり入力したりする）部分の機能がブラウザに伝わるようにしましょう。**

名前：ラベルとほぼ同義
役割：「これはボタン」「これはリンク」「これはチェックボックス」とか。
値：たぶん、inputの中に入れるテキストとか、チェックボックスがチェックされているか否か、とか

>この達成基準は、主に独自のユーザインタフェース コンポーネントを開発、又はスクリプトで実装するコンテンツ制作者に向けたものである。例えば、標準的な HTML のコントロールを仕様に沿って使用していれば、既にこの達成基準を満たしていることになる。

HTMLのinputで作ってる限りは気にしなくていいらしいです。

<!-- TODO なんでこれが堅牢なんですか？ -->

### 4.1.3 ステータスメッセージ (レベル AA)

> マークアップ言語を使って実装されたコンテンツでは、ステータスメッセージは、役割 (role) 又はプロパティを通してプログラムによる解釈が可能であり、フォーカスを受けとらなくても支援技術によってユーザに提示することができる。
> [達成基準 4.1.3: ステータスメッセージを理解する](https://waic.jp/translations/WCAG21/Understanding/status-messages.html)

**ステータスメッセージがブラウザに伝わるようにしましょう。**

はて、「ステータスメッセージ」ってなんでしょう？

>何がステータスメッセージの定義を満たすかどうかを判断する主な二つの基準がある：
>1. メッセージはアクションの成功又は結果、アプリケーションの待機状態、プロセスの進捗、又はエラーの存在に関する情報を利用者に提供する
>2. メッセージはコンテキストの変更によって配信されない

1はまあわかる、2はなんのこと？？

動的にコンテンツを表示する場合でも、検索結果のリストはステータスの更新とはみなされない。

>「検索結果が表示される」は、コンテキストの変化に関する情報
>https://a11y-guidelines.ameba.design/4/1/3/

らしい。

むしろ「コンテキスト」ってなんだ？？

>コンテキストの変化 (changes of context)
>ウェブページのコンテンツにおける大きな変化で、利用者が気づかないと、ウェブページ全体を一度に見ることのできない利用者を混乱させる恐れのあるもの。
>https://waic.jp/docs/WCAG21/Understanding/status-messages.html#dfn-change-of-context

？？

>1. ユーザエージェント
>2. ビューポート
>3. フォーカス
>4. ウェブページの意味を変えるコンテンツ

ふむ。

>コンテンツの変化が、必ずコンテキストの変化になるとはかぎらない。アウトラインの展開、動的なメニュー、又はタブの切替などのコンテンツの変化は、それが上記のいずれか (例: フォーカス) を変更しないかぎり、状況を変化させるとは限らない。

内容を変えること、ではなくて、混乱させうる変化かどうかなのか。
アラートダイアログがフォーカスを受け取るなども、コンテキストの変更の例。

で、ステータステキストがなんだったかというと、
コンテキストの変更ではないもの。
つまり、あえて伝えるための処理を行う必要がある。

「エラーが発生しましたよ！」とか、「処理が終わりましたよ！」とか、状態が変わったことを伝える。

`aria-live=assertive` や `role=alert` を使うらしい。具体的な実装については作ることになった場合に調べることにしよう。
https://waic.jp/docs/WCAG21/Techniques/aria/ARIA19

（ここからは私の解釈です）
なぜこれが「堅牢」「互換性を保つ」の基準なのかがよくわかりませんでした。

